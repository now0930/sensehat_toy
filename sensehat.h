#include <linux/cdev.h>
#define LPS25H (0x5c)	//humidity, temperature
#define LSM9DS1 (0x1c)	//accelometer
#define HTS221 (0x5f)	//humidity, temperature
#define LED_MAX 192
#define LED2472G (0x46)
#define DeviceName "sensehat_device"

struct hts221 {
	int T0_degC_x8;
	int T1_degC_x8;
	int H0_rH_x2;
	int H1_rH_x2;
	int T0_OUT;
	int T1_OUT;
	int H0_T0_OUT;
	int H1_T0_OUT;
	int T_OUT;
	int H_OUT;
	int T1T0MSB;
	int temperature;
};

struct rpisense {
	struct device *dev;
	struct i2c_client *i2c_client;
	struct hts221 hts221_data;
	struct cdev cdev_temperature;
	struct cdev cdev_humidity;
	char sending_temperature[40];
	char sending_humidity[40];
	char received_image[LED_MAX];
	/* Client devices */
};


const char default_image[LED_MAX] ={
	//first row
	//red channel; 0
	0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0,
	//blue channel; 8
	0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10,
	//green channel; 16
	0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0,

	//second row
	//red channel; 24
	0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0,
	//blue channel; 
	0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0,
	//green channel;
	0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10,

	//third row
	//red channel; 
	0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10,
	//blue channel; 
	0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0,
	//green channel;
	0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0,

	//4th row
	//red channel; 
	0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10,
	//blue channel; 
	0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0,
	//green channel;
	0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0,

	//5th row
	//red channel; 
	0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10,
	//blue channel; 
	0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0,
	//green channel;
	0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0,

	//6th channel
	//red channel; 
	0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10,
	//blue channel; 
	0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0,
	//green channel;
	0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0,

	//7th row
	//red channel; 
	0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10,
	//blue channel; 
	0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0,
	//green channel;
	0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0,

	//8th row
	//red channel; 
	0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10,
	//blue channel; 
	0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0,
	//green channel;
	0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0
};

static int temper_device_open(struct inode *, struct file *);
static int temper_device_release(struct inode *, struct file *);
static ssize_t temperature_read(struct file *, char *, size_t, loff_t *);
static ssize_t temper_ledmat_write(struct file *, const char *, size_t, loff_t *);

static int humidy_device_open(struct inode *, struct file *);
static int humidy_device_release(struct inode *, struct file *);
static ssize_t humidy_read(struct file *, char *, size_t, loff_t *);
static ssize_t humidy_ledmatix_write(struct file *, const char *, size_t, loff_t *);




int get_hts221(struct rpisense *rpisense_ptr);
void flush(struct rpisense *rpisense_ptr);


